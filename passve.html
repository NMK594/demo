<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>V√© c·ªßa t√¥i - Giao di·ªán Mobile</title>
    <link rel="stylesheet" href="styletang.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      /* Styles for sell-price input row and disabled button state */
      .sell-price-row {
        display: none;
        margin-top: 10px;
        gap: 8px;
        align-items: center;
      }
      .ticket-item.selected .sell-price-row { display: flex; flex-wrap:wrap; }
      .sell-price-input {
        appearance: none;
        -webkit-appearance: none;
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid rgba(255,255,255,0.08);
        background: rgba(255,255,255,0.03);
        color: #fff;
        width: 140px;
        box-sizing: border-box;
      }
      .sell-price-note {
        font-size: 13px;
        color: #cfe3ff;
      }
      .sell-price-error {
        color: #ffb4b4;
        font-size: 13px;
        margin-left: 6px;
      }
      .btn-gift.disabled {
        opacity: 0.5;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="phone-frame">
      <div class="status-bar">
        <span>10:08</span>
        <div>
          <i class="bi bi-wifi"></i>
          <span></span>
          <i class="bi bi-battery-half"></i>
        </div>
      </div>

      <div class="header-title">
        <h2>B√°n l·∫°i v√©</h2>
      </div>

      <div class="tabs-container">
        <button class="tab active" data-tab="upcoming">V√© c·ªßa t√¥i</button>
        
      </div>

      <div class="content-wrapper">
        <div id="upcoming" class="tab-content active">
  <div class="ticket-link">
  <div class="ticket-item" data-original-price="120000">
      <div class="select-box">
        <label><input type="checkbox" class="ticket-checkbox" aria-label="Ch·ªçn v√©"></label>
      </div>
      <div class="date-col">
        <span class="day">24</span>
        <span class="month">Th√°ng 11</span>
        <span class="year">2025</span>
      </div>
      <div class="info-col">
        <div class="circle top"></div>
        <div class="circle bottom"></div>
        <p class="event-title">
          LIVE CONCERT SKYNOTE 2025 
        </p>
        <div class="tags">
          <span class="tag success">Ch∆∞a s·ª≠ d·ª•ng</span>
          <span class="tag ticket">V√© ƒëi·ªán t·ª≠</span>
        </div>
        <p class="detail-line">
          <span class="icon">üïë</span> 19:00, 24 Th√°ng 11, 2025
        </p>
        <p class="detail-line">
          <span class="icon">üìç</span> S·ªë v√©: C478
        </p>
         <!-- sell price row (hidden until selected) -->
        <div class="sell-price-row">
          <input type="number" class="sell-price-input" min="0" placeholder="Gi√° b√°n (VND)" />
          <div class="sell-price-note">T·ªëi ƒëa: <strong class="orig-price">120000</strong>VND</div>
          <div class="sell-price-error" aria-live="polite"></div>
        </div>
      </div>
    </div>
  </a>

  <div class="ticket-item" data-original-price="120000">
    
    <div class="select-box">
      <label><input type="checkbox" class="ticket-checkbox" aria-label="Ch·ªçn v√©"></label>
    </div>
    <div class="date-col">
      <span class="day">20</span>
      <span class="month">Th√°ng 12</span>
      <span class="year">2025</span>
    </div>
    <div class="info-col">
      <div class="circle top"></div>
      <div class="circle bottom"></div>
      <p class="event-title">
     Y-CONCERT BY YEAH1

      </p>
      <div class="tags">
        <span class="tag success">Ch∆∞a s·ª≠ d·ª•ng</span>
        <span class="tag ticket">V√© ƒëi·ªán t·ª≠</span>
      </div>
      <p class="detail-line">
        <span class="icon">üïë</span> 14:00, 20 Th√°ng 12, 2025
      </p>
      <p class="detail-line">
        <span class="icon">üìç</span> S·ªë v√©: A764
      </p>
       <!-- sell price row (hidden until selected) -->
        <div class="sell-price-row">
          <input type="number" class="sell-price-input" min="0" placeholder="Gi√° b√°n (VND)" />
          <div class="sell-price-note">T·ªëi ƒëa: <strong class="orig-price">120000</strong>VND</div>
          <div class="sell-price-error" aria-live="polite"></div>
        </div>
    </div>
  </div>

 <div class="ticket-item" data-original-price="120000">
    <div class="select-box">
      <label><input type="checkbox" class="ticket-checkbox" aria-label="Ch·ªçn v√©"></label>
    </div>
    <div class="date-col">
      <span class="day">29</span>
      <span class="month">Th√°ng 11</span>
      <span class="year">2025</span>
    </div>
    <div class="info-col">
      <div class="circle top"></div>
      <div class="circle bottom"></div>
      <p class="event-title">
        SOOBIN LIVE CONCERT: ALL-ROUNDER THE FINAL
      </p>
      <div class="tags">
        <span class="tag success">Ch∆∞a s·ª≠ d·ª•ng</span>
        <span class="tag ticket">V√© ƒëi·ªán t·ª≠</span>
      </div>
      <p class="detail-line">
        <span class="icon">üïë</span> 19:00, 29 Th√°ng 11, 2025
      </p>
      <p class="detail-line">
        <span class="icon">üìç</span> S·ªë v√©: B982
      </p>
      <!-- sell price row (hidden until selected) -->
        <div class="sell-price-row">
          <input type="number" class="sell-price-input" min="0" placeholder="Gi√° b√°n (VND)" />
          <div class="sell-price-note">T·ªëi ƒëa: <strong class="orig-price">120000</strong>VND</div>
          <div class="sell-price-error" aria-live="polite"></div>
        </div>
    </div>
  </div>
</div>

  <div class="gift-wrap">
  <a class="btn-gift" role="button" href="" aria-label="T·∫∑ng v√©">B√°n v√©</a>
</div>
        <div class="suggestion-cards">
        
        </div>
      </div>

      <div class="footer-nav">
        <div class="nav-item">
          <span class="icon-text">t</span>
          <span class="label">Trang ch·ªß</span>
        </div>
        <div class="nav-item active">
          <span class="icon-active"></span>
          <span class="label">V√© c·ªßa t√¥i</span>
        </div>
        <div class="nav-item">
          <span class="icon-text">üë§</span>
          <span class="label">T√†i kho·∫£n</span>
        </div>
      </div>
      <div class="android-nav-bar">
        <span>&#9776;</span>
        <span>&#9675;</span>
        <span>&#9633;</span>
      </div>
    </div>
  <script>
document.addEventListener('DOMContentLoaded', () => {
  const sellBtn = document.querySelector('.btn-gift');
  const ticketItems = document.querySelectorAll('.ticket-item');

  // prevent anchors with .ticket-link from navigating (empty href)
  document.querySelectorAll('a.ticket-link').forEach(a => {
    a.addEventListener('click', e => e.preventDefault());
  });

  // populate displayed original prices from data-original-price (robust: avoid NaN)
  ticketItems.forEach(item => {
    const origValue = item.dataset.originalPrice;
    const orig = origValue ? Number(origValue) : 0;
    const origSpan = item.querySelector('.orig-price');
    if (origSpan) origSpan.textContent = orig ? orig.toLocaleString('vi-VN') : '‚Äî';
    item.dataset.originalPrice = String(orig);
  });

  // stop clicks inside inputs / sell-price-row from bubbling to parent
  ticketItems.forEach(item => {
    const inputs = item.querySelectorAll('input, .sell-price-row');
    inputs.forEach(el => {
      el.addEventListener('click', e => e.stopPropagation());
      el.addEventListener('mousedown', e => e.stopPropagation());
      el.addEventListener('touchstart', e => e.stopPropagation());
    });
  });

  function updateSellState() {
    let anySelected = false;
    let allValid = true;

    ticketItems.forEach(item => {
      const cb = item.querySelector('.ticket-checkbox');
      const row = item.querySelector('.sell-price-row');
      const input = item.querySelector('.sell-price-input');
      const err = item.querySelector('.sell-price-error');
      const orig = Number(item.dataset.originalPrice || 0);

      if (cb && cb.checked) item.classList.add('selected'); else item.classList.remove('selected');

      if (cb && cb.checked) {
        anySelected = true;
        const val = input && input.value !== '' ? Number(input.value) : NaN;
        if (!input || isNaN(val)) {
          allValid = false;
          if (err) err.textContent = 'Vui l√≤ng nh·∫≠p gi√° b√°n';
        } else if (orig > 0 && val > orig) {
          allValid = false;
          if (err) err.textContent = 'Gi√° ph·∫£i nh·ªè h∆°n ho·∫∑c b·∫±ng ' + orig.toLocaleString('vi-VN') + '‚Ç´';
        } else if (val <= 0) {
          allValid = false;
          if (err) err.textContent = 'Gi√° ph·∫£i l·ªõn h∆°n 0';
        } else {
          if (err) err.textContent = '';
        }
      } else {
        if (err) err.textContent = '';
      }
    });

    if (!anySelected || !allValid) {
      sellBtn.classList.add('disabled');
      sellBtn.setAttribute('aria-disabled', 'true');
    } else {
      sellBtn.classList.remove('disabled');
      sellBtn.removeAttribute('aria-disabled');
    }
  }

  // attach listeners
  ticketItems.forEach(item => {
    const cb = item.querySelector('.ticket-checkbox');
    const input = item.querySelector('.sell-price-input');

    if (cb) cb.addEventListener('change', () => updateSellState());
    if (input) {
      input.addEventListener('input', () => updateSellState());
      // ensure focusing input doesn't toggle parent selection
      input.addEventListener('focus', e => e.stopPropagation());
    }
  });

  updateSellState();

  sellBtn.addEventListener('click', (e) => {
    if (sellBtn.classList.contains('disabled')) { e.preventDefault(); return; }
    const selected = [];
   ticketItems.forEach(item => {
  item.addEventListener('click', e => {
    // N·∫øu click v√†o ch√≠nh item (kh√¥ng ph·∫£i checkbox), th√¨ kh√¥ng ƒë∆∞·ª£c toggle
    if (!e.target.classList.contains('ticket-checkbox') &&
        !e.target.closest('.ticket-checkbox')) {
      e.stopPropagation();
    }
  });
});
    ticketItems.forEach(item => {
      const cb = item.querySelector('.ticket-checkbox');
      const input = item.querySelector('.sell-price-input');
      if (cb && cb.checked) {
        const price = input && input.value !== '' ? Number(input.value) : null;
        selected.push({ item, price });
      }
    });
    if (selected.length === 0) { alert('Ch·ªçn √≠t nh·∫•t 1 v√© ƒë·ªÉ b√°n.'); return; }
    alert('G·ª≠i y√™u c·∫ßu b√°n th√†nh c√¥ng cho ' + selected.length + ' v√©.');
    location.href = 'chitietve2.html';
  });

});
</script>
  </body>
</html>
